# Financial-Modeling-Renewable-Energy
**Scenario assessment on intra-day scenarios**

run_script.ipynb is the Python notebook file to run that calculates the percentile for solar, wind and load. It calls the function generate_percentiles.py and scenario_models.py. RunEnergyScore.ipynb calculates the energy scores. generate_percentiles.py is the file that generate the percentile and save them in files. generate_ES2.py is the function that is called to generate the energy scores.

The notebook PITHistogramIntraDayWind.ipynb creates a variety of plots and numerical indicators of how well the scenarios cover the actuals on an hourly and daily basis for the wind data. It works with the percentile data and plots the heatmap, PIT histograms. PITHistogramIntraDaySolar.ipynb does the same for the solar data.

EnergyScore.m works on the energy score data. It calls energy score from all the aggregated assets, and plots it with date for load, solar, wind, all.
EnergyScoreZonalYear.m calls energy score for all the assets from different zones and plots the I_1, I_2, I_3, I_4 plots for solar, wind.

To check how good the PIT histogram works, how good it matches with the uniform distribution we check the KS score using the KSScoreValuesWind.m file. It works for the wind assets for the intra days and the DA.
Brier score test is another way to check how good the prediction is, to measure the accuracy of probabilistic forecasts. BrierScoreValuesWind.m calculates the Brier score for the event of generating zero wind prouction. It calls all the assets, and for each assets calculates the Brier scores for the event of zero wind generation and plot the histograms for the Brier score. MaxSolarWindGeneration.m is the file that uses two function BrierScoreCheck.m and BrierScoreCheckSolar.m that generates Brier score for all the assets for wind and Solar data and with them plots histograms for intradays and DA. 

**PCA analysis (for dimension reduction) and K-means algorithm (for clustering algorithm)**

These codes work on the data from ORFEUS on NREL test bed. Here we work on the Day ahead (DA) situation only. 

PCA_Assets.m is a function that does the PCA analysis. The input is the asset in Array. PCA_AllAssets3.m calls all the assets for a date, and for each assets calls the matlab function PCA_Assets.m, This is for doing the PCA for the asset and save the first four PCA factors and first four explained series in csv format for all the assets and for 365 days in a folder named Coefficient. 

PCA_AnimationAssets.m is for calculating the Animation video for the PCA factors in a time range using the output csv files generated by the PCA analysis. It calls the function PCA_Animation.m

PCA_AggregatedAsset.m shows the PC1 of individual assets and PC1 of the aggregated sum of all the assets for the eight zones. The aggregated sum quite well matches with the individual assets' overall shape for both the cases (solar \& wind)

IllustrationDAID.m shows that DA and intraday scenarios and forecasts, actual for any asset and date. IllustrationDA.m and IllustrationIDAll.m shows DA and intraday scenarios and forecasts, actual for aggregated asset for a date.

PCA_ExtremeScenario.m is for calculating the boundary of score phase space plot, i.e., showig the extreme scenarios 

TimeSeries05Dec.m is for calculating the time series of actual , forcast and mean and 2.75-97.5% scenario band for an asset on a day.

latent.m is a function that calculate the PCA factors when an array is passed as an input.
RepresentationScenario.m: Calls an asset, from a day and for that asset calculates representative scenarios using the K-means algorithm. The histogram from all scenarios and representative scenarios at different hours are compared and it matches well.

PCA_ExtremeScenarioAsset.m shows the extreme scenario by running the function PCA_ExtremeScenario.m and PCA_ExtremeScenario4.m

PCA_ExtremeScenarioAllAsset.m calls the function PCA_ExtremeScenarioWind.m and PCA_ExtremeScenarioSolar.m and check number of extreme scenarios for all assets and make distribution.

**RTS Simulation**

RTSPCA.m Calls all the wind/solar asset and the aggregated asset, from a day and for that assets
 Run the core PCA analysis on RTS scenarios (to double-check that we get the same patterns as for NREL-SRP output)

The code named with RTS, Process RTS sample scenarios to understand input-output relationship between RTS scenarios and Vatic outputs: (i) total daily system costs; (ii) lost load; (iii) renewable curtailment. Compare to definitions of extreme scenarios we tried before. The big question is how can we “predict” which scenarios will be extreme per Vatic. 
Identify the extreme scenarios (those that yield the 5% highest cost) for a couple of representative days
Make a scatter plot between total scenario renewable generation and total costs
Identify scenarios that lead to lost load, and those that lead to the highest curtailment. Provide interpretation for why those outcomes happen (eg very low generation, large generation drop at particular hour, etc)
Run the core PCA analysis on RTS scenarios (to double-check that we get the same patterns as for NREL-SRP output)

RTSDailySummaryFunction.m  is a function used to calculate the vatic output for different days.
RTSPCAWind.m analyze the PCA components of the aggregated wind assets and calls the function RTSDailySummaryFunction.m and establish the relationship between the PC components with the vatic output. Low PC components generates high generation cost and Load shed.
RTSPCANetLoad.m does the same analysis as RTSPCAWind.m for NetLoad. High PC components generates high generation cost and Load shed.
RTSRepresentativeScenario.m calculates the representattive scenarios using kmeans+knnsearch algorithm directly on 24 dimensioanl system and on the PCA components. It works on the Wind scenarios.

## Task: capture distribution of SCED generation costs using just 50 rather than 1000 scenarios
### Folder name: RepresentativeScenario ###
Run InputFile.m file to get the K-S score values for all dates for all three algorithms. \item Naive baseline $k_1$: random subsampling of scenarios. $k_2$: K-means directly on the 24-dim hourly scenarios of net load. $k_3$: PCA on the 24-dim net load scenarios, then K-means on the first four factor loadings.  The second alternative ($k_3$) works better. Assess subsampling performance using Kolmogorov-Smirnov statistic (lower is better) relative to the full cost distribution

